\documentclass[a4paper,11pt]{article}
\usepackage[spanish]{babel}
\selectlanguage{spanish}
\spanishdecimal{.} % Si se quiere definir el punto decimal como punto en vez de coma
\addto\captionsspanish{\def\tablename{Tabla}} % Para renombrar todos los 'Cuadro' con 'Tabla'.
\usepackage{fancyhdr}
\usepackage[dvips]{graphicx}
\usepackage[normal]{caption2}
\usepackage{amsfonts,amssymb,amsmath,amsthm}
\usepackage{moreverb}
\usepackage{url}
\usepackage[T1]{fontenc}
\pagestyle{fancy}

\pagestyle{fancy}
\lhead{Criptografía y Seguridad}
\chead{}
\rhead{ITBA}
\cfoot{\thepage}
\renewcommand{\footrulewidth}{0.4pt}

\newcommand{\expon}[1]{~10^{#1}}
\newcommand{\dif}[1]{\mathrm{d}#1}

% \\			Line break
% \today		Fecha del sistema
% \label{}		Etiqueta
% \ref{}		Referencia a la etiqueta del mismo nombre (a la sección)
% \footnote{}		Nota al pie de la página
% \underline{}		Subrayado
% \emph{}		Cursiva
% \textbf{}		Negrita
% \mbox{}		No separa lo que está entre corchetes
% \begin{}		Comienza el entorno entre corchetes
% \end{}		Termina el entrorno entre corchetes
% \thepage		Número de página
% \url{}		URL
% \section{}		Sección
% \subsection{}		Subsección
% \subsubsection{}	Subsubsección
% \frac{a}{b}		Fracción (a sobre b)
% a_t			A sub t (expr. matemática)
% $a$			Letra matemática a (puede ser por ejemplo \tau o directamente una letra

% Para enumerar:
% \begin{itemize}
% \item Enumerado 1.
% \item Enumerado 2.
% \end{itemize}

% Para poner eps:
% \begin{figure}
% \begin{center}
% \includegraphics[scale=0.6]{Nombre del eps}
% \caption{Lo que va a decir abajo}
% \label{Para hacerle referencia}
% \end{center}
% \end{figure}

% Para hacer ecuación:
% \begin{equation}
% \label{Para hacerle referencia}
% Expresion
% \end{equation}

% Para hacer ecuación alineando un igual (por columnas)
%\begin{eqnarray*}
%\label{Para hacerle referencia}
%X &=& 3 + 7\\
%&=& 10
%\end{eqnarray*}

% Para hacer tabla:
% \begin{table}
% \begin{center}
% \begin{tabular}{|c|c|} \hline Formato: cada pipe es una línea vertical.
% a & b \\ \hline Formato: cada \hline es una línea horizontal.
% \end{tabular}
% \caption{Nombre de la tabla.}
% \label{Para hacerle referencia}
% \end{center}
% \end{table}


\title{{\bf Modelado de Amenazas del sistema de voto electrónico \emph{Monkeyvote}}}
\author{M. Besio \and P. García \and E. Gómez Balaguer \and H. Rajchert}
\date{\today}

\begin{document}

\maketitle
\thispagestyle{fancy}

\tableofcontents
\newpage


\section{Introducción}
El objetivo de este trabajo es descubrir las potenciales amenazas y las vulnerabilidades presentes en la aplicación de voto electrónico \emph{Monkeyvote}\footnote{Se puede acceder a su código fuente de forma anónima mediante SVN en \url{http://monkeyvote.googlecode.com/svn/trunk}.}. El análisis es realizado considerando las mismas condiciones y supuestos para las que fue desarrollado el sistema.

\section{Modelado del sistema y del entorno}
En esta sección se hace un modelado detallado del funcionamiento del sistema y su entorno de uso para luego poder identificar amenazas específicas de diseño e implementación. Este proceso es crítico dado que nos permite ver al sistema desde el punto de vista de un atacante.

\subsection{Trust Levels}
Naturalmente, los niveles de confianza serán cuatro, y corresponderán a cada uno de los entes en que se divide el sistema. Dado que los servidores tienen un funcionamiento completamente autónomo se les puede asignar a cada uno encargados de su administración y asociarles un nivel de confianza. Por otro lado, los votantes también conforman un trust level separado. En la tabla \ref{trust_levels} se aprecian los niveles de confianza con un identificador y una descripción asociada.

 Las actividades para cada nivel de confianza serán muy distintas y por ninguna razón deberían mezclarse. Este es un sistema donde los límites están muy bien marcados, y como la seguridad es un aspecto absolutamente importante aquí, todo aquello que los trasgreda es un posible causal de malfuncionamiento.

\begin{table}
\begin{center}
\begin{tabular}{|c|c|c|} \hline
\textbf{ID} & \textbf{Nombre} & \textbf{Descripción}\\ \hline
1 & Votante & Persona registrada en el sistema\\
&& para votar.\\ \hline
2 & Administrador de \verb#Auth1# & Encargado de la administración del\\
&& servidor de autenticación 1.\\ \hline
3 & Administrador de \verb#Auth2# & Encargado de la administración del\\
&& servidor de autenticación 2.\\ \hline
4 & Administrador de \verb#Votos# & Encargado de la administración del\\
&& servidor de votos.\\ \hline
\end{tabular}
\caption{Trust levels. División en niveles de confianza para los participantes del sistema.}
\label{trust_levels}
\end{center}
\end{table}


\subsection{Escenarios de uso}
Aquí se identifican las posibles formas de efectuar el deployment del sistema, analizando qué escenario de uso configura cada una de ellas. Esto puede observarse en la tabla \ref{escenarios}. Nótese que si bien todas son posibles, no significa que sean recomendadas por los desarrolladores. Están aquí planteadas para que puedan ser tenidas en cuenta en el proceso de \textit{threat modeling} y se determine qué configuraciones no son soportadas por el sistema para funcionar bajo ciertos límites de seguridad.

Es importante destacar que tanto las aplicaciones servidor como el cliente sólo se ejecutan en entornos Linux, con lo cual las consideraciones de seguridad son estrictamente las inherentes a este sistema operativo. Por otro lado, no se consideran todas las variantes que pueden venir aparejadas a la ubicación remota de las bases de datos, dado que esta implementación las maneja de una forma completamente local mediante \verb#SQLite#\footnote{Referirse a \url{http://www.sqlite.org/} por más información.}.

\begin{table}
\begin{center}
\begin{tabular}{|c|c|} \hline
\textbf{ID} & \textbf{Descripción}\\ \hline
1 & Los servidores y el cliente se acceden\\
& mutuamente a través de Internet.\\ \hline
2 & Los tres servidores están montados\\
& en distintos hosts en la misma red y\\
& el cliente los accede desde Internet.\\ \hline
3 & Tanto el cliente como los servidores están\\
& en la misma red en distintos hosts.\\ \hline
4 & Los servidores están montados en un mismo host,\\
& y el cliente los accede desde Internet.\\ \hline
5 & Todas las aplicaciones del sistema\\
& están ejecutándose sobre un mismo host.\\ \hline
\end{tabular}
\caption{Escenarios de uso. Diferentes circunstancias en el uso del sistema.}
\label{escenarios}
\end{center}
\end{table}


\subsection{Entry Points}

Como es sistema de cuatro componentes que pueden intercambiar datos entre ellos
por un medio externo a ellos, para los puntos de entrada se los considera 
como sistemas distintos. Para profundizar el análisis, se debe tener en 
cuenta que hay dos tipos de aplicaciones, servidores y clientes.

Los servidores tienen la particularidad de que trabajan ``automáticamente'',
esto quiere decir que no requieren interacción de una persona y que, por lo
tanto, se limitan a tomar una entrada, procesarla, producir un cambio en su
estado interno y retornar una salida. Para ello, requieren de dos puntos de 
entrada, un \verb.Socket. de comunicaciones y un repositorio o base de datos
donde guardar su estado. El \verb.Socket. evidentemente es un punto de 
entrada, y el repositorio de datos se lo considera como tal porque de allí
el sistema toma datos para procesar requerimientos. En las tablas 
\ref{entryAuth1}, \ref{entryAuth2} y \ref{entryVotos} se pueden encontrar
tales puntos y sus descripciones.

El cliente merece una mención aparte, ya que a él ingresan datos de tres lugares:
el teclado, donde el usuario ingresa los datos; el sistema de archivos,
de donde el cliente lee la clave privada del usuario; y los \verb.Sockets.,
con los que se comunica con los distintos servidores.

\begin{table}
\begin{center}
\begin{tabular}{|r|l|l|l|} \hline
\textbf{ID} & \textbf{Nombre} & \textbf{Descripción} & \textbf{Trust levels} \\ \hline
1 &	Teclado				& El teclado se usa para ingresar las 	& 	(1) Votante\\
  &						& contraseñas y elecciones del usuario. &\\ \hline
2 & Sistema de 			& El sistema de archivos es donde se 	&	(1) Votante\\
  & archivos			& almacenan las claves privadas de los 	&\\
  &						& votantes. De allí son leídas por la 	&\\
  &						& aplicación cliente.					&\\ \hline 
3 &	\verb.Sockets.		& Los \verb.Sockets. son por donde la  	& 	(2) \verb·Auth1·\\
  &						& aplicación cliente se conecta con los	&	(3) \verb·Auth2·\\
  &						& servidores de votación.				&	(4) \verb·Votos·\\ \hline
\end{tabular}
\caption{Puntos de entrada al sistema cliente.}
\label{entryCli}
\end{center}
\end{table}

\begin{table}
\begin{center}
\begin{tabular}{|r|l|l|l|} \hline
\textbf{ID} & \textbf{Nombre} & \textbf{Descripción} & \textbf{Trust levels} \\ \hline
1 &	Repositorio de 			& El repositorio de datos es el		& (2) \verb.Auth1.\\ 
  &	datos					& lugar donde residen los datos de 	&	\\
  &							& los usuarios y las encuestas.		& 	\\ \hline
2 &	\verb.Sockets.			& El servidor de autenticación 		& (1) \verb·Votante·\\
  &							& espera requerimientos de ingreso 	& (4) \verb.Votos.\\ 
  &							& al sistema escuchando en un 		& \\
  &							& \verb Socket . Asimismo utiliza 	& \\
  &							& éste entry point para la 			& \\
  &							& comunicación con los clientes y	& \\ 
  &							& el servidor de votos.				& \\\hline
\end{tabular}
\caption{Puntos de entrada al sistema de autenticación.}
\label{entryAuth1}
\end{center}
\end{table}

\begin{table}
\begin{center}
\begin{tabular}{|r|l|l|l|} \hline
\textbf{ID} & \textbf{Nombre} & \textbf{Descripción} & \textbf{Trust levels} \\ \hline
1 &	Repositorio de 			& El repositorio de datos es el		& (2) \verb.Auth2.\\
  & datos					& lugar donde residen los datos de  & \\
  &							& los usuarios.						& \\ \hline
2 &	\verb.Sockets.			& El servidor de autenticación		& (1) \verb·Votante·\\
  &							& secundario espera requerimientos  & (4) \verb·Votos·\\
  &							& de ingreso al sistema escuchando  & \\
  &							& en un \verb Socket . Asismismo, 	& \\
  &							& utiliza éste punto de entrada para& \\
  &							& comunicación con clientes y el 	& \\
  &							& servidor de votos.				& \\ \hline
\end{tabular}
\caption{Puntos de entrada al sistema de autenticación secundario.}
\label{entryAuth2}
\end{center}
\end{table}

\begin{table}
\begin{center}
\begin{tabular}{|r|l|l|l|} \hline
\textbf{ID} & \textbf{Nombre} & \textbf{Descripción} & \textbf{Trust levels} \\ \hline
1 &	Repositorio de 			& El repositorio de datos es el 	& 	(4) \verb.Votos.\\
  & datos					& lugar donde residen los votos y	& \\
  &							& certificados de votación.			& \\ \hline
2 &	\verb.Sockets.			& El servidor de votos espera por	& 	(1) \verb·Votante·\\
  &							& mensajes de los servidores de 	&	(2) \verb·Auth1·\\
  &							& autenticación y del cliente. 		&	(3) \verb·Auth2·\\
  &							& También usa este punto de entrada & \\
  &							& para comunicarse con ellos.		& \\ \hline
\end{tabular}
\caption{Puntos de entrada al sistema de servidor de votos.}
\label{entryVotos}
\end{center}
\end{table}

\subsection{Assets}
En esta clase de sistemas hay distintos tipos de daño. El primer daño posible es
el cambio de información, ya sea en registros de habilitación o en los registros
que contengan los votos de las personas. Además, el sistema se considera dañado
si en algún momento se anula el anonimato de la información, ya que es una
premisa de la que se parte. Otro tipo de daño se puede efectuar haciendo una
denegación de servicio o anulación intencional y sistemática de las votaciones
en curso. Por lo tanto, los objetivos que podrían ser blanco de un ataque por 
parte de algún interesado en hacer daño serán los de la tabla \ref{assets}.

\begin{table}
\begin{center}
\begin{tabular}{|r|l|l|l|} \hline
\textbf{ID} & \textbf{Nombre} & \textbf{Descripción} & \textbf{Trust levels} \\ \hline
1	& Votos					& Los votos	contienen las opciones	& (4) \verb.Votos. 	\\
	&						& elegidas por los votantes.		& (1) \verb.Votante.\\ \hline
2	& Registros primarios	& Los registros primarios contienen & (2) \verb.Auth1.	\\ 
	&						& a los usuarios, sus roles, sus 	& (1) \verb.Votante.\\
	&						& claves públicas y su estado en la & \\ 
	&						& participación de cada encuesta.	& \\ \hline
3	& Registros secundarios	& Los registros secundarios 		& (3) \verb.Auth2.	\\
	& 						& contienen a los usuarios y sus 	& (1) \verb.Votante.\\
	&						& claves públicas.					& \\ \hline
4	& Certificados de 		& Los certificados de voto que emite& (1) \verb.Votante. \\
	& votación				& el votante y firma el servidor de & (4) \verb.Votos. \\
	&						& votos.							& \\ \hline
4	& Anonimato				& Los votos son anónimos.			& (1) \verb.Votante.\\ \hline
5	& Claves privadas 		& Las claves privadas de cada 		& (1) \verb.Votante.\\
	& de los votantes		& votante.							& \\ \hline
6	& Clave privada del		& La clave privada del servidor 	& (2) \verb.Auth1. \\
	& servidor de 			& de autenticación.					& \\ 
	& autenticación			&									& \\ \hline
7	& Clave privada del		& La clave privada del servidor 	& (3) \verb.Auth2. \\
	& servidor secundario	& de autenticación secundario.		& \\ 
	& de autenticación		&									& \\ \hline
8	& Clave privada del		& La clave privada del servidor 	& (4) \verb.Votos. \\
	& servidor de votos		& de votos.							& \\ \hline
9	& Contraseñas			& Las contraseñas de cada votante	& (1) \verb.Votante.\\ \hline
10	& Consistencia de los	& Los registros de votos con sus	& (4) \verb.Votos.	\\ 
	& registros de votos	& pares voto/certificado.			& (1) \verb.Votante.\\ \hline
11	& Prestación de servicio& El servicio está disponible		& (1) \verb.Votante.\\ 
	& 						& para el votante mientras dure la  & \\
	&						& elección.							& \\ \hline
	
\end{tabular}
\caption{Objetivos/Assets.}
\label{assets}
\end{center}
\end{table}


\subsection{Dependencias externas}

En esta sección de enumeran aquellos sistemas externos al analizado que en caso de falla o no disponibilidad pueden exponer vulnerabilidades.

\begin{table}[h!]
\begin{center}
\begin{tabular}{|c|c|c|} \hline
\textbf{ID} & \textbf{Nombre} & \textbf{Descripción}  \\ \hline
1 & Base de datos & El sistema utiliza una base de datos para \\&&almacenamiento de votos y validación de usuarios \\&& que es necesario esté disponible \\ \hline
2 & Alimentación eléctrica  & Debe encontrarse disponible para \\&& que un cliente  o un servidor no intenten \\&& conectarse a otro servidor \\&& que se encuentra offline \\ \hline
3 & Generador de claves & Debe ser lo suficientemente confiable como \\&& para evitar que un atacante aproveche \\&& vulnerabilidades y logre regenerar una o más \\&& claves de los votantes o los servidores \\ \hline
4 & Bibliotecas externas & Deben ofrecer niveles de encriptación iguales o mayores a \\&& los del sistema para evitar exponer información sensible \\&& durante una consulta \\ \hline
	
\end{tabular}
\caption{Dependencias externas}
\end{center}
\end{table}



\subsection{Notas de seguridad}

Esta sección presenta diversas notas de interés, en el caso de las externas, para los usuarios que darán uso a este sistema, y en el caso de las internas, para explicar algunos \emph{tradeoff} realizados en la implementación.

\subsubsection{Externas}

En la tabla \ref{next} se enuncian las notas de seguridad externas.

\begin{table}[h!]
\begin{center}
\begin{tabular}{|c|c|} \hline
\textbf{ID} & \textbf{Descripción}  \\ \hline
1 & El soporte con las claves debe mantenerse \\& a resguardo
para evitar exponer la clave privada \\ \hline
2 & La clave para autenticarse contra el servidor \\& debe mantenerse en el más absoluto \\& secreto para evitar que vote un impostor \\ \hline
3 & Preferentemente se debe evitar el uso de \\& caracteres acentuados o ñ \\& para evitar potenciales inconvenientes con el \\& encoding de la base de datos \\ \hline

\end{tabular}
\caption{Notas de seguridad externas}\label{next}
\end{center}
\end{table}

\subsubsection{Internas}

En la tabla \ref{nint} se enuncian las notas de seguridad externas.

\begin{table}[h!]
\begin{center}
\begin{tabular}{|c|c|} \hline
\textbf{ID} & \textbf{Descripción}  \\ \hline
1 & Se utiliza encriptación por clave simétrica, \\& ésto evita inconvenientes surgen al \\& utilizar claves asimétricas pero requiere \\& circular inicialmente una clave que \\& de obtenerse compromete la seguridad \\& de la votación\\ \hline
2 & El tiempo de votación es limitado para \\& impedir ataques que tomen un tiempo prolongado \\& para producir un potencial resultado \\ \hline


\end{tabular}
\caption{Notas de seguridad internas}\label{nint}
\end{center}
\end{table}

\subsection{DFD del sistema}

En las figuras \ref{dfd0}, \ref{dfd1} \ref{dfd2} pueden verse los niveles 0, 1 y 2 del DFD del sistema.

\begin{center}
\begin{figure}[h!]
\includegraphics[scale=0.65]{dfd0}\label{dfd0}
\caption{DFD nivel 0}
\end{figure}
\end{center}

\begin{center}
\begin{figure}[h!]
\includegraphics[scale=0.65]{dfd1}\label{dfd1}
\caption{DFD nivel 1}
\end{figure}
\end{center}

\begin{center}
\begin{figure}[h!]
\includegraphics[scale=0.68, angle=90]{dfd2}\label{dfd2}
\caption{DFD nivel 2}
\end{figure}
\end{center}

\section{Modelado de amenazas y detección de vulnerabilidades}
(Próxima entrega.)


\begin{thebibliography}{99}
\bibitem{MSDN}\url{http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnpag2/html/tmwa.asp}.
\end{thebibliography}

\begin{center}
\tiny{\emph{Made with \LaTeX}}
\end{center}

\end{document}

